### Provide better privacy

* Enhance user’s privacy (based on the original protocols)
* Build new built-in privacy-preserving cryptocurrencies/blockchain, using privacy-preserving cryptographic primitives

1. Hide the receiver/source
2. Hide the sender/destination
3. Hide the amount

### Coin-Mix

Definition: Users send their coins to the address of the service provider; After collecting sufficient coins from DIFFERENT users, the SP issues transactions to send the coins to the addresses of corresponding users, maybe from time to time; SP charges for the service.

### Coin-Shuffle

A decentralized protocol where users collectively create a single transaction that shuffles their coins. Each user receives coins back to a fresh address, ensuring that there is no link between the incoming and outgoing coins. No trusted third party is required, and no single user has enough information to trace the coins.

### Monero(XMR)

1. Hide the receiver using **Stealth Address**
2. Hide the sender using (Linkable) **Ring Signature**
3. Hide the amount using **Commitment**

### Stealth Address

* The Payer: $r\leftarrow_R Z_p$ ; $R=rG$ ; calculate $PK_R=H(rA)G+B$
* The Public: $A=aG, B=bG$ ; $addr:=(R,PK_R)$ ; A-> public view key; B-> public spend key
* The Payee: $(a,b)\in Z_p$

Monitor the blockchain to check whether a TXO has an address $addr:=(R,PK_R)$ such that $PK_R=H(aR)G+B=sk_RG$. If it holds, compute $sk_R=H(aR)+b$.

Summary: ==$PK_R=H(rA)G+B=H(aR)G+B=sk_RG=(H(aR)+b)G$==

* **Privacy:** Each coin receiving address is freshly generated, with random $r$.
* **Security:** Only the payee knows the value of $b$, thus only the payee can spend the coin.
* **Convenience:** From the view of B, for each transaction output, he needs to run the check one time.

* **Enhance Security and convenience:** Even an adversary compromises the value of $a$, he is not able to spend the coins.

### Ring Signature

* Correctness: For any $Setup(\lambda)\to PP$, any message $M$ in message space, any $R=(PK_1,\cdots,PK_l)$ such that $(PK_i,SK_i)\leftarrow KeyGen(PP)(\text{for } i =1,\cdots,l)$, any $s\in\{1,\cdots,l\}$, it holds that

$Verify(PP,R,M,Sign(PP,R,M,PK_s,SK_s))=1$.

* Security-Unforgeability: Given a ring $R=(PK_1,\cdots,PK_l)$, only having one of the corresponding private keys, a user can generate a valid signature with respect to $R$.

<img src="C:\Users\NP_123\AppData\Roaming\Typora\typora-user-images\image-20231230192836351.png" alt="image-20231230192836351" style="zoom:80%;" />

*  Security-**Anonymity**: Given a tuple $(R,M,\sigma)$ such that $Verify(PP,R,M,\sigma)=1$, it is **infeasible to identify the signer’s public key out of $R$.**

![Anonymity](D:\Work\密码学\Anonymity.png)

### Linkable Ring Signature(prevent double-spending)

$Link(PP,R_1,M_1,\sigma_1,R_2,M_2,\sigma_2)\to 1/0$

Given two valid signature, say $Verify(PP,R_1,M_1,\sigma_1)=1 \text{ for }i=1,2$, the algorithm returns 1, implying the two signatures are generated by the same public key, otherwise returns 0.

* Security-Linkability: No adversary can generate two signatures using the same public key, while the $Link$ algorithm returns that they are unlinked.
* Security-Non-slanderability: Given a public key $PK$ and a corresponding signature $\sigma$ with respect to $(R,M)$, without the corresponding private key, no adversary can generate a tuple $(R^{'},M^{'},\sigma^{'})$ such that (1) $Verify(PP,R^{'},M^{'},\sigma^{'})=1$ and (2) $Link(PP,R,M,\sigma,R^{'},M^{'},\sigma^{'})=1$.

Each transaction output generates a unique **key image** that is a cryptographic representation of the sender's private key. When a transaction is broadcast to the network, miners check the **key image** against a list of all key images previously used in the blockchain. If the key image has already been used, the transaction is rejected as a double-spend attempt

### Commitment(hide amount in cryptocurrencies)

$Setup(1^\lambda)\to ck$ generates the public commitment key $ck$, including a message space $S_M$, a randomness space $S_R$, and a commitment space $S_C$.

$Commit_{ck}(m,r)\to C=rG+mH$            $Open_{ck}(C,m^{'},r^{'})\to 1/0$

* Security-Hiding: The commitment $c$ gives the adversary no information about the value $m$.

* Security-Binding: commitment $c$ cannot be opened in two different ways.

* Additively Homomorphic: $Commit(m,r)+Commit(m^{'},r^{'})=Commit(m+m^{'},r+r^{'})$,

  Thus, the prover only needs to prove that $C-C^{'}$ is a commitment of 0.

When the miners check the validity of a transaction, they do not care the amounts, and they only need to make sure that the **value of consumed coins equals to that of generated coins**.

Each commitment should be accompanied by a **zero-knowledge proof** proving $v\in[0,V]$, without leaking the value of $v$.

### Extended Linkable Ring Signature

When Linkable Ring Signature is used to hide the sender, the case of multiple inputs (i.e. a transaction consumes multiple coins) needs to be considered.



