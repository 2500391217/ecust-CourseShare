# **第5部分**    **设备管理**

学习重点：

##### 1. 设备管理功能：

​	监视设备状态，进行设备分配，完成I/O操作，缓冲管理与虚拟设备等。
​	隐藏物理设备的细节
​	与设备的无关性（抽象的I/O命令、逻辑设备名称、可移植性即插即用）
​	提高CPU和I/O设备的利用率（并行操作）
​	对I/O设备进行控制（4种方式）
​	确保对设备的正确共享、错误处理、缓冲技术



##### 2. 设备管理的主要任务：

​	完成用户提出的I/O 请求，为用户分配I/O 设备；
​	提高CPU 和I/O设备的利用率；
​	提高I/O速度；
​	以及方便用户使用I/O设备。

设备管理的主要对象：I/O设备和相应的设备控制器



##### 3. 设备的一般分类（==按信息交换单位分类：字符设备和块设备==）：

·按使用特性（信息交换）单位分类：
	存储设备（块设备）
	输入/输出设备（字符设备）
·按照==使用方式==来分类：
	==独占设备==、==共享设备==、==虚拟设备(目的是把独占设备改造成共享设备，经典例子是SPOOLing技术的打印机)==；
·按传输速率来分类：
	高速设备、中速设备、低速设备。



##### 4. UNIX操作系统把输入/输出设备看作是特殊文件。



##### 5、设备控制器的组成：
​	设备控制器与处理机（CPU）的接口；
​	设备控制器与（I/O）设备的接口；
​	I/O逻辑。



##### 6、I/O通道：
​	通道是一个独立于CPU，专门管理输入输出的处理器，它控制外设与内存之间的信息交换。



##### 7. 解决因通道不足产生的瓶颈问题的方法：

​	增加设备到主机间的通路而不是增加通道。
​	具体地说，就是把一个设备连接到多个控制器上，而一个控制器又连接到多个通道上。
​	这种多通路方式不仅可以解决瓶颈问题，而且能够提高系统的可靠性，也即不会因为个别通道或控制器的故障而使设备与存储器之间无法建立通路进行数据传输。



##### 8. 一个进程只有在获得了==所需设备==、==设备控制器==和==通道==后，才具备了进行I/O操作的物质条件。



##### 9. 设备驱动程序 I/O控制方式（四种）：

	使用轮询的可编程I/O方式（程序I/O方式，CPU与设备串行，资源利用率低）
	使用==中断==的可编程I/O方式（中断驱动I/O控制方式，可以成百倍的提高CPU的利用率，以及系统吞吐量）（==通常在CPU把当前指令处理完[或者一个指令周期]之后处理中断，处理完毕之后再回到中断的现场继续执行==）
	直接存储器访问DMA I/O控制方式（相比于I/O方式数据==传输单位从字节变为了块，所以通常用来**磁盘控制**==，此外==不需要CPU干预，数据直接从设备流向内存==，==当把一个块的数据调入到内存缓冲区之后DMA控制器向CPU发送中断信号，CPU直接到内存取数据交给用户进程执行==）
	I/O通道控制方式（需要CPU干预最少，I/O操作是由通道执行通道程序完成的，相较于DMA变为了==离散的多个数据块==）



##### 10. 设备独立性概念及其优点；

​	为提高OS的可适应性和可扩展性，而将应用程序独立于具体使用的物理设备。==用户程序申请I/O设备时，通常采用**逻辑设备名**==（具体指派哪一个物理设备为进程服务是由操作系统的设备管理完成的）。
​	向用户提供使用外部设备的方便、统一的接口。
​	所谓“方便”，是指用户能独立于具体设备的复杂物理特性而方便地使用设备；
​	所谓“统一”，是指不同设备尽量能统一操作方式。
​	“方便”和“统一”要求对用户屏蔽实现具体设备I/O操作的细节，呈现给用户的是一种性能理想化的、操作简便的逻辑设备。
​	系统的这种性能也称为设备的独立性。



##### 11、设备独立性软件 设备分配时所使用的数据结构

四张表：
	==设备控制表==--DCT：记录每一个设备的相关情况（设备控制器指针）
	==控制器控制表==--COCT：记录设备控制器的相关信息（控制了这台设备控制器的通道）
	==通道控制表==--CHCT
	==系统设备表==--SDT：记录当前系统下所有设备的情况

​	==设备分配过程==：
​		用户使用逻辑设备名引出设备请求——
​		操作系统从系统设备表找到同一类的物理设备——
​		查找物理设备对应的设备控制表拿到控制器指针——
​		查控制器控制表找到对应通道——
​		查通道控制表看是否空闲，三个都空闲就分配——
​		分配完毕后在每个进程对应的逻辑设备表中添加表项记录逻辑设备名对应的物理设备以及设备驱动的地址。



##### 12. 设备分配算法：

​	先来先服务、优先级高者优先。



##### 13. SPOOLing系统的组成、功能和实现思想。

组成：
	输入井和输出井；
	输入缓冲区和输出缓冲区；
	输入进程和输出进程；
	井管理程序

功能：将一台物理I/O设备虚拟为多台逻辑I/O设备

实现思想：是对脱机输入输出系统的模拟，建立在通道技术和多道程序技术的基础上，以高速随机外存为后援存储器

特点：提高了I/O的速度，将独占设备改造为共享设备，实现了虚拟设备的功能，提高了设备的利用率。

目的：虚拟分配，==将独占设备改造为共享设备==




##### 15. 什么是虚拟设备，实现虚拟设备的关键技术是什么。如何实现共享打印机。		P222



##### 16. 磁盘存储器管理（一定不会在大题中出现）：

​	磁盘存取访问时间包括：寻道时间、旋转延迟时间、数据传送时间。
​	==各种磁盘调度算法==（能够用FCFS、SSTF、扫描算法和循环扫描算法计算寻道时间）。



##### 17. 使用缓冲技术的目的

为了使多个进程能有效地同时处理输入输出，最好使用缓冲池结构的缓冲技术。
	·缓和CPU与I/O设备之间速度不匹配的矛盾
	·减少对CPU的中断频率，放宽对CPU中断响应时间的限制
	·解决数据粒度不匹配的问题
	·提高CPU和I/O设备之间的并行性



##### 18、缓冲区的类型

**单缓冲：max(c,t)+m**
**双缓冲：max(c,t)**
循环缓冲和缓冲池
为了使多个进程能有效地同时处理输入输出，**最好使用缓冲池**结构的缓冲技术。

缓冲池：管理机制 + 多个缓冲区
						：缓冲首部 + 缓冲体